<html>
<head>
	<link href="lib/c3.css" rel="stylesheet" type="text/css">
	<link href="lib/bootstrap.min.css" rel="stylesheet" type="text/css">

	<script src="lib/d3.min.js" charset="utf-8"></script>
	<script src="lib/c3.js" type="text/javascript"></script>
	<script src="lib/peg-0.8.0.min.js" type="text/javascript"></script>
	<script src="lib/parser.js" type="text/javascript"></script>

	<script type="text/javascript">
		function parse(n) {
			var text = document.getElementById("input").value;
			var parsed = parser.parse(text)
			var output = JSON.stringify(parsed, null, 4); 

			document.getElementById("tree").style.display = 'none';
			document.getElementById("code").innerHTML = output;

        	var modData = [];
          var chartType
          var chartTypeArr = ['bar','pie','line','area','area-spline','donut','scatter']

          if(n==0){
              chartType = parsed[1].value
          } else {
              chartType = chartTypeArr[n]
          }
           	parsed[0].array.forEach(function(d, i) {
             	var item = [d.type];
              item.push(d.value);
             	modData.push(item);
			});
            console.log(modData)
           	var chart = c3.generate({
            	data: {
             	json: modData, type: chartType,
              color: {
              pattern: ['#1f77b4', '#aec7e8', '#ff7f0e', '#ffbb78', '#2ca02c', '#98df8a', '#d62728', '#ff9896', '#9467bd', '#c5b0d5', '#8c564b', '#c49c94', '#e377c2', '#f7b6d2', '#7f7f7f', '#c7c7c7', '#bcbd22', '#dbdb8d', '#17becf', '#9edae5']
    }
             }
           });
		}
	</script>	
</head>

<body>
	<div class="container-fluid">
		<div class="row">
			<div class="col-md-5 col-md-offset-1">
				<h3>Chart code</h3>
				<textarea id="input" name="input" class="form-control" rows="20">
#data: 1,2,3
#type: bar
#color: red</textarea>
				<input class="btn btn-default label-success" type="submit" value="PLOT" onclick="parse(0)">
               <input class="btn btn-default" type="submit" value="SAVE SVG">
               <input class="btn btn-default" type="submit" value="Bar" onclick="parse(0)">
               <input class="btn btn-default" type="submit" value="Pie" onclick="parse(1)">
               <input class="btn btn-default" type="submit" value="Line" onclick="parse(2)">
               <input class="btn btn-default" type="submit" value="Area" onclick="parse(3)">
               <input class="btn btn-default" type="submit" value="Area Spline" onclick="parse(4)">
               <input class="btn btn-default" type="submit" value="Donut" onclick="parse(5)">
               <input class="btn btn-default" type="submit" value="Scatter" onclick="parse(6)"><br/><br/>

			<div id="chart" class="col-md-12 col-md-offset-0" style="height:40%;">
					
				</div>


			</div>
		
			<div class="col-md-5 col-md-offset-0">
				<h3>Tree</h3>
				<p id="tree">Parse tree will appear here</p>
				<pre id="code"></pre>
			</div>

		</div>
	</div>
</body>
</html>



</head>
<body>